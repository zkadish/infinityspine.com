{"version":3,"file":"home.js","sources":["webpack:///webpack/bootstrap","webpack:///./src/js/constants.js","webpack:///./src/js/home.js","webpack:///./src/js/router.js"],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/js/home.js\");\n","// const MAIN_NAV = ['about', 'treatments', 'testimonials', 'blog', 'forms', 'contact'];\nconst MAIN_NAV = ['treatments', 'testimonials', 'articles', 'forms', 'contact'];\nconst REVIEWS_ONE = 'uxte1J82H2vgWAbiXjypx3VRQYUQFwvYoHsy9HQWbYlSE4USBY';\nconst REVIEWS_TWO = 'Gx4RiWADI875OX4K4uiWJiVqmbm5cpGf8UM9DT6WYRBQB5PJOK';\n\nexport {\n  MAIN_NAV,\n  REVIEWS_ONE,\n  REVIEWS_TWO,\n}\n","\nimport { routes, onRouterEventHandler } from './router';\n\nconst treatmentRoutes = routes.slice(0, 4);\nconst treatmentBtns = document.querySelectorAll('.treatments__btn');\nconst testimonialsBtn = document.querySelector('.testimonials__btn button');\nconst blogPreviewBtns = document.querySelectorAll('.articles-preview__btn');\nconst blogPreviewImages = document.querySelectorAll('.articles-preview-image img');\nconst blogPreviewTitles = document.querySelectorAll('.articles-preview__post h2');\nconst blogPreviewExcerpts = document.querySelectorAll('.articles-preview__excerpt');\n\nfetch('http://infinityspine.com/wp-json/wp/v2/posts?per_page=3')\n  .then(response => response.json())\n  .then((posts) => {\n    const featuredMedia = posts.map(post => post.featured_media);\n\n    const blogTitles = posts.map(post => post.title.rendered);\n    const blogExcerpt = posts.map(post => post.excerpt.rendered);\n\n    blogPreviewTitles.forEach((t, i) => {\n      const title = t;\n      if (!blogTitles[i]) return;\n      title.innerHTML = blogTitles[i];\n    });\n\n    blogPreviewExcerpts.forEach((e, i) => {\n      const excerpt = e;\n      if (!blogExcerpt[i]) return;\n      const index = blogExcerpt[i].indexOf('</p>');\n      const html = `${blogExcerpt[i].slice(0, index)}</p>`;\n      excerpt.innerHTML = html;\n    });\n\n    Promise.all(\n      featuredMedia.map(media => fetch(`http://infinityspine.com/wp-json/wp/v2/media/${media}`)\n        .then(response => response.json())\n        .then(data => data.media_details.sizes.medium)),\n    ).then((arr) => {\n      blogPreviewImages.forEach((img, i) => {\n        if (!arr[i]) return undefined;\n        return img.setAttribute('src', arr[i].source_url);\n      });\n    });\n  });\n\n// treatments read-more buttons\ntreatmentBtns.forEach((btn, i) => {\n  function treatmentBtnsClickHandler() {\n    window.history.pushState(null, null, treatmentRoutes[i]);\n    onRouterEventHandler();\n  }\n  btn.addEventListener('click', treatmentBtnsClickHandler);\n});\n\nblogPreviewBtns.forEach((btn, i) => {\n  function blogPreviewBtnsClickHandler(e) {\n    window.history.pushState(null, null, '#dr-thoma-articles');\n    /**\n     * onRouterEventHandler()\n     * @param [{object}, number] - event object, article uri param value '?article=1'\n     */\n    const articleNum = i + 1;\n    onRouterEventHandler(e, articleNum);\n  }\n  btn.addEventListener('click', blogPreviewBtnsClickHandler);\n});\n\n// testimonials more button\nfunction testimonialsBtnClickHandler() {\n  window.history.pushState(null, null, '#more-testimonials');\n  onRouterEventHandler();\n}\ntestimonialsBtn.addEventListener('click', testimonialsBtnClickHandler);\n\nconst splash01 = document.querySelector('#splash-01');\n\nfunction matchMedia() {\n  if (window.matchMedia('(min-width: 1920px)').matches) {\n    // console.log('home.js - desk1920');\n    // initMainNavButtons();\n    splash01.setAttribute('src', 'img/splash-01.png');\n  }\n\n  if (window.matchMedia('(max-width: 1919px) and (min-width: 1600px)').matches) {\n    // console.log('home.js - desk1600');\n    // initMainNavButtons();\n    splash01.setAttribute('src', 'img/splash-01.png');\n  }\n\n  if (window.matchMedia('(max-width: 1599px) and (min-width: 1440px)').matches) {\n    // console.log('home.js - desk1440');\n    // initMainNavButtons();\n    splash01.setAttribute('src', 'img/splash-01.png');\n  }\n\n  if (window.matchMedia('(max-width: 1439px) and (min-width: 1280px)').matches) {\n    // console.log('home.js - desk1280');\n    // initMainNavButtons();\n    splash01.setAttribute('src', 'img/splash-01.png');\n  }\n\n  if (window.matchMedia('(max-width: 1279px) and (min-width: 1024px)').matches) {\n    // console.log('home.js - desk1024');\n    // initMainNavButtons();\n    splash01.setAttribute('src', 'img/splash-01.png');\n  }\n\n  if (window.matchMedia('(max-width: 1023px) and (min-width: 864px)').matches) {\n    // console.log('home.js - tab864');\n    // initMainNavButtons();\n    splash01.setAttribute('src', 'img/splash-01.png');\n  }\n\n  if (window.matchMedia('(max-width: 863px) and (min-width: 480px)').matches) {\n    // console.log('home.js - pho480');\n    // initMobileNavButtons();\n    splash01.setAttribute('src', 'img/splash-01-pho480.png');\n  }\n\n  if (window.matchMedia('(max-width: 479px) and (min-width: 0px)').matches) {\n    // console.log('home.js - phone');\n    // initMobileNavButtons();\n    splash01.setAttribute('src', 'img/splash-01-pho480.png');\n  }\n}\nmatchMedia();\n\nwindow.onresize = () => {\n  matchMedia();\n};\n","import { REVIEWS_ONE, REVIEWS_TWO } from './constants';\n\nconst { origin, pathname } = window.location;\nconst body = document.querySelector('body');\nconst container = document.querySelector('.container');\n\n// live site at infinityspine.com\nlet root = '/';\n\n// localhost apache server\nif (pathname === '/infinity-spine/public/') {\n  root = '/infinity-spine/public/';\n}\n\n// when site runs on new.infinityspine.com\n// folder is public_html/new/\nif (pathname === '/new/') {\n  root = '/new/';\n}\n\nexport const routes = [\n  '#nucca-chiropractic',\n  '#sports-physiotherapy',\n  '#functional-medicine',\n  '#red-near-infrared-therapy',\n  '#mission-vision',\n  '#about-dr-thoma',\n  '#corrective-exercises',\n  '#performance-exercise',\n  '#customized-nutrition',\n  '#welcome',\n  '#dr-thoma-articles',\n  '#new-patient-forms',\n  '#faqs',\n  '#more-testimonials',\n  '#contact',\n  '#directions',\n  '#home',\n];\n\nlet page = window.location.hash;\n\nfunction testimonialTags(token) {\n  // TODO: look for a better solution... Cache the original HTML?\n  const scriptToken = document.createElement('script');\n  scriptToken.setAttribute('type', 'text/javascript');\n  scriptToken.innerHTML = (`\n    var review_token = \"${token}\"; \n    var review_target = 'review-container';\n  `);\n\n  const scriptReview = document.createElement('script');\n  scriptReview.setAttribute('type', 'text/javascript');\n  scriptReview.setAttribute('src', 'https://reviewsonmywebsite.com/js/embed.js?v=7');\n\n  const reviewContainer = document.createElement('div');\n  reviewContainer.id = 'review-container';\n\n  return [scriptToken, scriptReview, reviewContainer];\n}\n\nfunction getRouteContent(newRoute, anchor, article) {\n\n  fetch(`${origin}${root}pages/${newRoute}.html`)\n    .then(response => response.text())\n    .then((response) => {\n      // remove javascript page <script></script> if it exists\n      const pageScript = document.querySelectorAll(`[src=\"js/${page.replace('#', '')}.js\"]`);\n      if (pageScript) {\n        pageScript.forEach((script) => {\n          body.removeChild(script);\n        });\n      }\n\n      // reset page\n      page = newRoute;\n      // update \"master page\"\n      container.innerHTML = response;\n    }).then(() => {\n      const script = document.createElement('script');\n      script.setAttribute('id', page);\n\n      // route specific HTML and Javascript\n      if (page === 'home' || page === '') {\n        const reviews = document.querySelector('.testimonials .mdc-layout-grid__cell');\n        script.setAttribute('src', 'js/home.js');\n        // insert page specific javascript\n        body.appendChild(script);\n        testimonialTags(REVIEWS_ONE).forEach(node => reviews.appendChild(node));\n\n        if (!anchor) {\n          window.history.replaceState({}, '', '#home');\n        }\n      }\n\n      if (page === 'contact') {\n        script.setAttribute('src', 'js/contact.js');\n        // insert page specific javascript\n        body.appendChild(script);\n\n        if (!anchor) {\n          window.history.replaceState({}, '', '#contact');\n        }\n      }\n\n      if (page === 'dr-thoma-articles') {\n        script.setAttribute('src', 'js/dr-thoma-articles.js');\n        // insert page specific javascript\n        body.appendChild(script);\n\n        if (!anchor) {\n          window.history.replaceState({}, '', `#dr-thoma-articles?article=${article}`);\n        }\n      }\n\n      if (page === 'more-testimonials') {\n        const reviews = document.querySelector('.testimonials .mdc-layout-grid__cell');\n        testimonialTags(REVIEWS_TWO).forEach(node => reviews.appendChild(node));\n      }\n\n      // make sure loaded content starts at the top...\n      window.scroll(0, 0);\n\n      // replay the anchor tag...\n      document.location = window.location.hash;\n    })\n    .catch((error) => {\n      // TODO: route to 404 error page\n      console.error('Error:', error); // eslint-disable-line\n    });\n}\n\n// get route\nexport function onRouterEventHandler(e, article) {\n  if (e) e.preventDefault();\n  let hash = window.location.hash.split('?')[0];\n  if (pathname === root && hash === '') {\n    hash = '#home';\n  }\n\n  if (routes.includes(hash)) {\n    const route = hash.replace(/#/g, '').split('?')[0];\n    getRouteContent(route, '', article);\n    return;\n  }\n\n  // below code handles anchor hrefs\n  const dataRoutes = [...document.querySelectorAll('[data-route]')]\n    .map(r => r.dataset.route.replace('#', ''));\n\n  const ids = [...document.querySelectorAll('[id]')]\n    .map(id => id.id);\n\n  // some anchors are also routes\n  // the main menu buttons work this way\n  // when on the home page the btns are anchors\n  // when on another page the btns take the\n  // user back to the home page and the anchors\n  // spot on the home page\n  const routesAll = [...ids, ...dataRoutes];\n  const isAnchor = routesAll.some(route => route === hash.replace('#', ''));\n\n  if (!isAnchor) {\n    window.location = 'pages/404.html';\n    return;\n  }\n\n  // if hash is an anchor on the home page\n  getRouteContent('home', window.location.hash.replace(/#/g, ''));\n}\n\n/**\n * When user refreshes the browser\n * onLoad event listener\n * Handler - anonymous function\n * @param {object} - event\n */\nwindow.addEventListener('load', (e) => {\n  let article = null;\n  const { hash } = window.location;\n  if (hash.includes('article')) {\n    article = hash.slice(hash.indexOf('?article') + 9);\n  }\n\n  onRouterEventHandler(e, article);\n}, false);\n\n/**\n * When user changes the URL\n * onHashchange event listener\n * Handler - anonymous function\n * @param {object} - event\n */\nwindow.addEventListener('hashchange', (e) => {\n  let article = null;\n  const { hash } = window.location;\n\n  // TODO: use articleNum() from dr-thoma-articles.js\n  // get article num\n  if (hash.includes('article')) {\n    article = hash.slice(hash.indexOf('?article') + 9);\n  }\n\n  // if hash is in routes\n  if (routes.includes(hash.split('?')[0])) {\n    onRouterEventHandler(e, article);\n    return;\n  }\n\n  // select all dom elements with id attributes\n  const idTags = document.querySelectorAll('[id]');\n  let ids = [];\n  idTags.forEach(tag => ids.push(`#${tag.id}`));\n\n  // if hash has a matching id on the page its an anchor link\n  // execute the onRouterEventHandler\n  if (!ids.includes(hash)) {\n    ids = [];\n    onRouterEventHandler();\n  }\n}, false);\n\n// these events might get used in a refactor of the router\n// window.addEventListener('beforeunload', () => {\n//   console.log('beforeunload');\n// }, false);\n\n// window.addEventListener('unload', () => {\n//   console.log('unload event');\n// }, false);\n\n// window.addEventListener('loadstart', () => {\n//   console.log('loadstart event');\n// }, false);\n\nwindow.addEventListener('error', (err) => {\n  // debugger;\n  console.log('error event', err); // eslint-disable-line\n}, false);\n"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;;;;;ACFA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;;;;;AAIA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACjIA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAGA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAoBA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;AAMA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;AAMA;AACA;AADA;AAKA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}